"use strict";(()=>{var p=eG("BACKENDS","").split(","),u=r=>{let o=[];return r.forEach(l=>{o.push({c:l.shortcode,u:l.url})}),o},_=async function(r,o){let l=new URL(r.url),s={lastIDs:{}},n=[];for(let a=0;a<p.length;a++){let e=p[a],d=`https://${e}/api/v1/timelines/public?local=true&only_media=false`;try{(await(await fetch(d)).json()).forEach(t=>{s.lastIDs[e]=t.id;let i={type:"post",server:e,app:{name:t?.application?.name||"Unknown",link:t?.application?.website||"about:blank"},user:{at:t.account.username,name:t.account.display_name,id:t.account.id,emoji:u(t.account.emojis),bot:t.account.bot,locked:t.account.locked,url:t.account.url},create:new Date(t.created_at).getTime(),post:t.content,emoji:u(t.emojis),favs:t.favourites_ount,boosts:t.reblogs_count,replies:t.replies_count,lang:t.language,cw:t.sensitive,cwt:t.spoiler_text,reach:t.visibility,url:t.url,media:t.media_attachments,refer:t.mentions,poll:t.poll};t.edited_at&&(i.edit=new Date(t.edited_at).getTime()),t.in_reply_to_id&&(i.reply=t.in_reply_to_id,i.replyTo=t.in_reply_to_account_id),n.push(i)})}catch(c){n.push({type:"error",create:Date.now(),server:e,stack:c.stack})}}return n.sort((a,e)=>Math.sign(e.create-a.create)),s.timeline=n,new Response(JSON.stringify(s),{headers:{"Content-Type":"application/json"}})};})();
